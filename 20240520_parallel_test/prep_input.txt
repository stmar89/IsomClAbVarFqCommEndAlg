/* vim: set syntax=magma : */
/*
*/


    PP<x>:=PolynomialRing(Integers());
    all:=Split(Read("~/IsomClassesAbVarFqComEnd/weil_poly_all.txt"));
    tot:=#all;
    ps:=[ 2,3,5,7 ];
    a_max:=4;

    perc:=0;
    for icc->cc in all do
        if Truncate(100*icc/tot) gt perc then perc+:=1; printf "%o%% ",perc; end if;
        coeff:=eval(cc);
        h:=PP!coeff;
        if IsSquarefree(h) then
            g:=Degree(h) div 2;
            q:=Truncate(ConstantCoefficient(h)^(1/g));
            _,p,a:=IsPrimePower(q);
            if p in ps and a le a_max
                and not IsCoprime(coeff[g+1],q) // exclude ordinary
                        then
                fprintf "~/IsomClassesAbVarFqComEnd/20240520_parallel_test/input.txt","%o\n",cc;
            end if;
        end if;
    end for;

